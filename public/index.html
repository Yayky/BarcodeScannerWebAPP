<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Barcode Scanner</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/@ericblade/quagga2/dist/quagga.min.js"></script>
    <style>
        .scanner-overlay {
            position: relative;
            width: 100%;
            max-width: 640px;
            margin: 0 auto;
        }
        #interactive.viewport {
            position: relative;
            width: 100%;
            height: 300px;
        }
        #interactive.viewport > canvas, #interactive.viewport > video {
            max-width: 100%;
            width: 100%;
        }
        canvas.drawing, canvas.drawingBuffer {
            position: absolute;
            left: 0;
            top: 0;
        }
        .mode-select {
            margin-bottom: 20px;
        }
        .progress-container {
            margin: 20px 0;
        }
        .product-image {
            max-width: 300px;
            height: auto;
        }
        .description-section {
            margin: 15px 0;
            padding: 15px;
            border: 1px solid #dee2e6;
            border-radius: 4px;
        }
        .description-section h4 {
            color: #495057;
            margin-bottom: 10px;
        }
        .scan-region {
            border: 2px solid #28a745;
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 200px;
            height: 100px;
        }
    </style>
</head>
<body>
    <div class="container mt-4">
        <h1 class="text-center mb-4">Barcode Scanner</h1>

        <!-- Mode Selection -->
        <div class="mode-select text-center">
            <div class="btn-group" role="group">
                <button id="scanButton" class="btn btn-primary">Camera Scan</button>
                <button id="manualButton" class="btn btn-secondary">Manual Input</button>
            </div>
        </div>

        <!-- Scanner Container -->
        <div id="scanner-container" class="text-center">
            <div class="scanner-overlay">
                <div id="interactive" class="viewport">
                    <video id="video"></video>
                    <canvas id="canvas" class="drawingBuffer"></canvas>
                    <div class="scan-region"></div>
                </div>
            </div>
        </div>

        <!-- Manual Input Container -->
        <div id="manualInputContainer" class="text-center d-none">
            <div class="input-group mb-3 w-50 mx-auto">
                <input type="text" id="barcodeInput" class="form-control" placeholder="Enter barcode number">
                <button id="submitBarcode" class="btn btn-primary">Search</button>
            </div>
        </div>

        <!-- Loading Indicator -->
        <div id="loading" class="d-none">
            <div class="progress-container">
                <div class="progress">
                    <div id="search-progress" class="progress-bar progress-bar-striped progress-bar-animated" 
                         role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100">
                    </div>
                </div>
                <div class="text-center mt-2">
                    <p id="progress-text">Initializing search...</p>
                    <small id="progress-status" class="text-muted">Starting product search...</small>
                </div>
            </div>
        </div>

        <!-- Product Information -->
        <div id="product-info" class="mt-4 d-none">
            <div class="row">
                <div class="col-md-4 text-center">
                    <img id="product-image" class="product-image img-fluid mb-3" src="" alt="Product Image">
                    <div class="mb-3">
                        <a id="product-link" href="#" target="_blank" class="btn btn-outline-primary d-none">
                            View on Website
                        </a>
                    </div>
                </div>
                <div class="col-md-8">
                    <h2 id="product-title" class="mb-3"></h2>
                    <div class="mb-3">
                        <strong>SKU:</strong> <span id="product-sku"></span><br>
                        <strong>Size:</strong> <span id="product-size"></span>
                    </div>
                    
                    <div class="description-section">
                        <h4>Description</h4>
                        <div id="general-description"></div>
                    </div>
                    
                    <div class="description-section">
                        <h4>Material Information</h4>
                        <div id="material-info"></div>
                    </div>
                    
                    <div class="description-section">
                        <h4>Additional Details</h4>
                        <div id="additional-details"></div>
                    </div>
                    
                    <div class="description-section">
                        <h4>Size Information</h4>
                        <div id="size-table"></div>
                    </div>
                </div>
            </div>
            
            <div class="text-center mt-4">
                <button id="scan-again" class="btn btn-primary">Scan Another Product</button>
            </div>
        </div>
    </div>

    <script src="app.js"></script>
</body>
</html>
